(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-539af210"],{"03b7":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{ref:"content",staticClass:"page-otcDetailOrder a-5-bg"},[a("vue-scroll",[a("div",{staticClass:"page-otcDetailOrder-bar"},[a("Title",{ref:"title",attrs:{isReady:t.isReady,commonData:t.commonData},on:{getData:t.getData}}),a("Message",{attrs:{isReady:t.isReady,commonData:t.commonData},on:{"update:identificationShow":function(e){t.identificationShow=!0}}}),a("div",{staticClass:"otcDetailOrder-options"},[a("Pays",{attrs:{isReady:t.isReady,commonData:t.commonData,payObj:t.payObj},on:{setPayObj:t.setPayObj}}),t.orderIsReady?a("div",{staticClass:"otcDetailOrder-buttons"},["1"===t.status&&"BUY"===t.commonData.side?a("div",[a("c-button",{attrs:{paddingW:"40px",disabled:t.goPayDisabled},on:{click:t.goPayClick}},[t._v(t._s(t.$t("otcDetailOrder.goPay")))]),a("c-button",{staticClass:"textButtonClass",attrs:{paddingW:"40px",type:"text",height:"40px"},on:{click:t.cancelOrderClick}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.CancellationOrder"))+"\n              ")])],1):t._e(),"1"===t.status&&"SELL"===t.commonData.side?a("div",[a("c-button",{attrs:{paddingW:"40px",disabled:!0}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.WaitingPayment"))+"\n            ")])],1):t._e(),"2"===t.status?a("div",["BUY"===t.commonData.side?a("c-button",{attrs:{paddingW:"40px",disabled:!0}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.WaitingPuttingMoney"))+"\n            ")]):t._e(),"SELL"===t.commonData.side?a("c-button",{attrs:{paddingW:"40px"},on:{click:t.releaseClick}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.ConfirmReleaseMoney"))+"\n            ")]):t._e(),a("c-button",{staticClass:"textButtonClass",attrs:{paddingW:"40px",type:"text",height:"40px"},on:{click:t.appealClick}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.SubmitAcomplaint"))+"\n            ")])],1):t._e(),"3"===t.status||"8"===t.status?a("div",[a("c-button",{attrs:{paddingW:"40px"},on:{click:t.goHall}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.goHall"))+"\n            ")])],1):t._e(),"4"===t.status||"9"===t.status?a("div",[a("c-button",{attrs:{paddingW:"40px",disabled:!0}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.OrderClosed"))+"\n            ")])],1):t._e(),"5"===t.status?a("div",[a("c-button",{attrs:{paddingW:"40px",disabled:!0}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.OrdersAppeal"))+"\n            ")]),"1"===t.axiosData.isComplainUser.toString()?a("c-button",{staticClass:"textButtonClass",attrs:{paddingW:"40px",type:"text",height:"40px"},on:{click:t.cancelAppealClick}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.CancellationComplaint"))+"\n            ")]):t._e()],1):t._e(),"7"===t.status?a("div",[a("c-button",{attrs:{paddingW:"40px",disabled:!0}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.OrderException"))+"\n            ")])],1):t._e()]):t._e(),a("c-otcReminder")],1),a("chatVue",{attrs:{chatTop:t.chatTop,isReady:t.isReady,commonData:t.commonData}}),a("c-alert",{attrs:{showFlag:!1,imgMap:t.imgMap}}),t.maxEvmFlag?a("div",{staticClass:"maxEvmAll u-7-bg",on:{click:function(e){return t.maxEvm(!1)}}}):t._e(),t.maxEvmFlag?a("div",{staticClass:"maxEvm h-2-bg",on:{click:function(e){return t.maxEvm(!1)}}},[a("img",{attrs:{src:t.payObj.qrcodeImg}})]):t._e(),a("c-dialog",{attrs:{showFlag:t.goPayFlag,titleText:t.$t("otcDetailOrder.ConfirmPayment"),confirmText:t.$t("otcDetailOrder.MarkedAsPaid"),closeText:t.$t("otcDetailOrder.NotYetPaid"),confirmLoading:t.gopayConfirmLoading,paddingTop:"20px"},on:{close:t.goPayClose,confirm:t.gopayConfirm}},[a("div",{staticClass:"goPayDialog"},[a("p",{staticClass:"text"},[a("svg",{staticClass:"icon icon-16",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-c_2"}})]),t._v(" \n            "),a("span",{staticClass:"b-7-cl"},[t._v(t._s(t.$t("otcDetailOrder.payWarning")))])]),a("ul",{staticClass:"list"},[a("li",{staticClass:"a-4-bg"},[a("div",[t._v("\n                "+t._s(t.$t("otcDetailOrder.PaymentAmount"))+"\n              ")]),a("div",{staticClass:"value b-1-cl"},[t._v(t._s(t.goPayText.price))])]),a("li",{staticClass:"a-4-bg"},[a("div",[t._v(t._s(t.$t("otcDetailOrder.Otherparty"))+"\n                "+t._s(t.payObj.name))]),a("div",{staticClass:"value b-1-cl",class:"otc.payment.alipay"===t.payObj.payment||"otc.payment.wxpay"===t.payObj.payment?"haveEvm":""},["otc.payment.alipay"===t.payObj.payment||"otc.payment.wxpay"===t.payObj.payment?a("span",[t._v("\n                  "+t._s(t.payObj.userName)+" "+t._s(t.payObj.account)+"\n                  "),a("div",{staticClass:"payEvm",style:{backgroundImage:"url("+t.payObj.qrcodeImg+")"},on:{click:function(e){return t.maxEvm(!0)}}})]):"otc.payment.domestic.bank.transfer"===t.payObj.payment?a("span",[t._v("\n                  "+t._s(t.payObj.userName)+"\n                  "+t._s(t.payObj.account)+"\n                  "+t._s(t.payObj.bankName)+"\n                  "+t._s(t.payObj.bankOfDeposit)+"\n                ")]):a("span",[t._v("\n                  "+t._s(t.payObj.userName)+"\n                  "+t._s(t.payObj.account)+"\n                ")])])]),a("li",{staticClass:"a-4-bg"},[a("div",[t._v(t._s(t.$t("otcDetailOrder.PaymentReference")))]),a("div",{staticClass:"value b-1-cl"},[t._v(t._s(t.goPayText.id))])])])])]),a("c-dialog",{attrs:{showFlag:t.releaseFlag,titleText:t.$t("otcDetailOrder.ConfirmReleaseMoney"),paddingTop:"20px",confirmDisabled:t.releaseConfirmDisbale,confirmLoading:t.releaseConfirmLoading},on:{confirm:t.releaseConfirm,close:t.releaseClose}},[a("div",{staticClass:"releaseDialog"},[a("p",{staticClass:"text"},[a("svg",{staticClass:"icon icon-16",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-c_2"}})]),t._v(" \n            "),a("span",{staticClass:"b-7-cl"},[t._v(t._s(t.$t("otcDetailOrder.ConfirmReleaseMoneyWarning")))])]),a("c-inputLine",{attrs:{promptText:t.$t("otcDetailOrder.pass"),inputType:"password",name:"passValue",value:t.passValue,marginTop:"10px",errorHave:!0,errorFlag:t.passErrorFlag,errorText:t.$t("otcDetailOrder.passError")},on:{onchanges:t.inputLineChange}}),a("div",{staticClass:"passValueText"},[a("c-checkBox",{attrs:{value:t.passCheck},on:{click:t.passCheckClick}}),t._v(" \n            "),a("span",{staticClass:"passValueText-text",on:{click:t.passCheckClick}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.ConfirmReleaseMoneyConfrim")))])],1)],1)]),a("c-dialog",{attrs:{showFlag:t.cancelOrderFlag,titleText:t.$t("otcDetailOrder.CancellationOrderTitle"),paddingTop:"20px",confirmLoading:t.cancelOrderLoading,confirmDisabled:t.cancelOrderConfirmDisabled},on:{close:t.cancelOrderClose,confirm:t.cancelOrderConfirm}},[a("div",{staticClass:"cancelOrderDialog"},[a("ul",[a("li",[t._v(t._s(t.$t("otcDetailOrder.CancellationOrderWarning1")))]),a("li",[t._v(t._s(t.$t("otcDetailOrder.CancellationOrderWarning2")))])]),a("div",{staticClass:"cancelOrderDialog-check"},[a("c-checkBox",{attrs:{value:t.cancelOrderCheck},on:{click:t.cancelOrderCheckClick}}),t._v(" \n            "),a("span",{staticClass:"cancelOrderDialog-check-text",on:{click:t.cancelOrderCheckClick}},[t._v("\n              "+t._s(t.$t("otcDetailOrder.CancellationOrderConfrim")))])],1)])]),a("c-dialog",{attrs:{showFlag:t.appealFlag,titleText:t.$t("otcDetailOrder.AppealTitle"),paddingTop:"20px",confirmLoading:t.appealLoading,confirmDisabled:t.appealConfirmDisabled},on:{close:t.appealClose,confirm:t.appealConfirm}},[a("div",{staticClass:"appealDialog"},[a("p",{staticClass:"text"},[a("svg",{staticClass:"icon icon-16",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-c_2"}})]),t._v(" \n            "),a("span",{staticClass:"b-7-cl"},[t._v(t._s(t.$t("otcDetailOrder.AppealWarning")))])]),a("c-textAreaLine",{attrs:{promptText:t.$t("otcDetailOrder.ReasonsAppeal"),name:"appealValue",value:t.appealValue,marginTop:"10px",maxLength:"200",warningText:t.appealValue.length+"/200",errorHave:!0},on:{onchanges:t.inputLineChange}})],1)]),a("c-dialog",{attrs:{showFlag:t.cancelAppealFlag,titleText:t.$t("otcDetailOrder.CancellationComplaintTitle"),paddingTop:"40px",confirmLoading:t.cancelAppealLoading},on:{close:t.cancelAppealClose,confirm:t.cancelAppealConfirm}},[a("div",{staticClass:"cancelAppealDialog"},[t._v("\n          "+t._s(t.$t("otcDetailOrder.CancellationComplaintConfrim"))+"\n        ")])]),a("c-dialog",{staticClass:"connection-dialog",attrs:{titleText:t.$t("otcDetailOrder.connection"),showFlag:t.identificationShow},on:{close:function(e){t.identificationShow=!1},confirm:function(e){t.identificationShow=!1}}},[t.identificationInfo.isTwoMin?a("ul",{staticClass:"connection-list"},[t.identificationInfo.mobileNumber?a("li",{staticClass:"connection-li a-4-bg"},[a("p",{staticClass:"connection-title b-2-cl"},[t._v(t._s(t.$t("otcDetailOrder.phone")))]),a("p",{staticClass:"connection-desc b-1-cl"},[t._v(t._s(t.identificationInfo.mobileNumber))])]):t._e(),t.identificationInfo.email?a("li",{staticClass:"connection-li a-4-bg"},[a("p",{staticClass:"connection-title b-2-cl"},[t._v(t._s(t.$t("register.email")))]),a("p",{staticClass:"connection-desc b-1-cl"},[t._v(t._s(t.identificationInfo.email))])]):t._e()]):a("p",{staticClass:"towMin"},[t._v(t._s(t.$t("otcDetailOrder.twoMin")))])])],1)])],1)},i=[],r=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("bd86")),n=(a("6b54"),a("87b3"),a("c5f6"),a("95d5"));function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var l={data:function(){return{timer:null,orderIsReady:!1,orderId:"",axiosData:{},payObj:{},cancelOrderFlag:!1,cancelOrderCheck:!1,cancelOrderLoading:!1,goPayFlag:!1,gopayConfirmLoading:!1,releaseFlag:!1,passValue:"",passCheck:!1,releaseConfirmLoading:!1,appealFlag:!1,appealValue:"",appealLoading:!1,cancelAppealFlag:!1,cancelAppealLoading:!1,chatTop:0,maxEvmFlag:!1,imgMap:n["u"],colorMap:n["c"],identificationShow:!1}},watch:{status:function(t){var e=this;t&&this.$nextTick((function(){var t=e.$refs.title;e.chatTop=t.$el.offsetHeight}))}},computed:{identificationInfo:function(){var t={},e={SELL:"buyer",BUY:"seller"};if(this.commonData.side){var a=this.commonData[e[this.commonData.side]];a&&(t.realName=a.realName,t.mobileNumber=a.mobileNumber,t.email=a.email,t.isTwoMin=Number(this.commonData.isTwoMin))}return t},goPayText:function(){var t="",e="",a=this.commonData,s=a.sequence,i=a.totalPrice,r=a.paycoin;return s&&(e=s.substring(s.length-6)),i&&r&&(t="".concat(i," ").concat(r)),{id:e,price:t}},goPayDisabled:function(){var t=!0;return this.payObj.payment&&(t=!1),t},passFlag:function(){return this.$store.state.regExp.passWord.test(this.passValue)},passErrorFlag:function(){return 0!==this.passValue.length&&!this.passFlag},releaseConfirmDisbale:function(){var t=!0;return(this.passCheck&&this.passFlag||this.releaseConfirmLoading)&&(t=!1),t},appealConfirmDisabled:function(){var t=!0;return(this.appealValue.length||this.appealLoading)&&(t=!1),t},cancelOrderConfirmDisabled:function(){var t=!0;return(this.cancelOrderCheck||this.cancelOrderLoading)&&(t=!1),t},status:function(){return this.commonData.status?this.commonData.status.toString():"0"},baseData:function(){return this.$store.state.baseData},userInfo:function(){return this.$store.state.baseData.userInfo},isLogin:function(){return this.$store.state.baseData.isLogin},isReady:function(){var t=!1;return this.isLogin&&this.orderIsReady&&(t=!0),t},commonData:function(){var t={};if(this.isReady&&this.userInfo.id&&this.axiosData.seller&&this.axiosData.seller.uid){var e=this.userInfo.id.toString()===this.axiosData.seller.uid.toString()?"SELL":"BUY";t=c(c({},this.axiosData),{side:e})}return t},market:function(){return this.$store.state.baseData.market},priceFix:function(){var t=this.$store.state.baseData.defaultFiatPrecision,e=this.commonData,a=e.coin,s=e.paycoin;return this.market&&this.market.coinList[a]&&this.market.coinList[a].fiatPrecision&&this.market.coinList[a].fiatPrecision[s.toLowerCase()]&&(t=this.market.coinList[a].fiatPrecision[s.toLowerCase()]),Number(t)},volumeFix:function(){var t="",e=this.commonData.coin;return this.market&&e&&this.market.coinList[e]&&this.market.coinList[e].showPrecision&&(t=this.market.coinList[e].showPrecision),Number(t)}},beforeDestroy:function(){clearInterval(this.timer)},methods:{init:function(){var t=this.$route.query.orderId;t&&(this.orderId=t,this.getData())},maxEvm:function(t){this.maxEvmFlag=t},getData:function(){var t=this;clearInterval(this.timer),this.timer=setInterval((function(){t.initOrder(!0)}),1e4),this.initOrder()},initOrder:function(t){var e=this,a={};t&&(a["exchange-auto"]="1"),this.axios({url:"v4/otc/order_detail",params:{sequence:this.orderId,headers:a},hostType:"otc"}).then((function(t){"0"===t.code.toString()?(e.orderIsReady=!0,e.axiosData=t.data,e.axiosData.price=Object(n["f"])(e.axiosData.price,e.priceFix),e.axiosData.totalPrice=Object(n["f"])(e.axiosData.totalPrice,e.priceFix),e.axiosData.volume=Object(n["f"])(e.axiosData.volume,e.volumeFix)):e.$bus.$emit("tip",{text:t.msg,type:"error"})}))},setPayObj:function(t){this.payObj=t},goPayClick:function(){this.goPayFlag=!0},goPayClose:function(){this.goPayFlag=!1},gopayConfirm:function(){var t=this;this.gopayConfirmLoading=!0,this.axios({url:"/v4/otc/order_payed",hostType:"otc",params:{sequence:this.orderId,payment:this.payObj.payment}}).then((function(e){t.gopayConfirmLoading=!1,"0"===e.code.toString()?(t.getData(),t.$bus.$emit("tip",{text:e.msg,type:"success"}),t.goPayFlag=!1):t.$bus.$emit("tip",{text:e.msg,type:"error"})}))},releaseClick:function(){this.releaseFlag=!0},passCheckClick:function(){this.passCheck=!this.passCheck},releaseClose:function(){this.releaseFlag=!1,this.passValue="",this.passCheck=!1},releaseConfirm:function(){var t=this;this.releaseConfirmLoading=!0;var e="otc/confirm_order";this.axios({url:e,hostType:"otc",params:{sequence:this.orderId,capitalPword:this.passValue}}).then((function(e){t.releaseConfirmLoading=!1,"0"===e.code.toString()?(t.getData(),t.$bus.$emit("tip",{text:e.msg,type:"success"}),t.releaseClose()):t.$bus.$emit("tip",{text:e.msg,type:"error"})}))},appealClick:function(){var t=(new Date).getTime(),e=t-this.axiosData.payTime;e<=3e5?this.$bus.$emit("tip",{text:this.$t("otcDetailOrder.AppealTitleFive"),type:"warning"}):this.appealFlag=!0},appealClose:function(){this.appealFlag=!1,this.appealValue=""},appealConfirm:function(){var t=this;this.appealLoading=!0,this.axios({url:"/question/create_problem",params:{rqType:"BUY"===this.commonData.side?8:9,rqDescribe:this.appealValue}}).then((function(e){if("0"===e.code.toString()){var a="otc/complain_order";t.axios({url:a,hostType:"otc",params:{sequence:t.orderId,complainId:e.data.complainId}}).then((function(e){t.appealLoading=!1,"0"===e.code.toString()?(t.getData(),t.appealClose(),t.$bus.$emit("tip",{text:e.msg,type:"success"})):t.$bus.$emit("tip",{text:e.msg,type:"error"})}))}else t.appealLoading=!1,t.$bus.$emit("tip",{text:e.msg,type:"error"})}))},cancelAppealClick:function(){this.cancelAppealFlag=!0},cancelAppealClose:function(){this.cancelAppealFlag=!1},cancelAppealConfirm:function(){var t=this;this.cancelAppealLoading=!0;var e="otc/complain_cancel";this.axios({hostType:"otc",url:e,params:{sequence:this.orderId}}).then((function(e){t.cancelAppealLoading=!1,"0"===e.code.toString()?(t.getData(),t.$bus.$emit("tip",{text:e.msg,type:"success"}),t.cancelAppealClose()):t.$bus.$emit("tip",{text:e.msg,type:"error"})}))},cancelOrderClick:function(){this.cancelOrderFlag=!0},cancelOrderCheckClick:function(){this.cancelOrderCheck=!this.cancelOrderCheck},cancelOrderClose:function(){this.cancelOrderFlag=!1,this.cancelOrderCheck=!1},cancelOrderConfirm:function(){var t=this;this.cancelOrderLoading=!0;var e="otc/order_cancel";this.axios({url:e,hostType:"otc",params:{sequence:this.orderId}}).then((function(e){t.cancelOrderLoading=!1,"0"===e.code.toString()?(t.getData(),t.$bus.$emit("tip",{text:e.msg,type:"success"}),t.cancelOrderClose()):t.$bus.$emit("tip",{text:e.msg,type:"error"})}))},inputLineChange:function(t,e){this[e]=t},goHall:function(){this.$router.push("/")}}},u=(a("57f9"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"otcDetailOrder-header a-3-bd"},[a("section",{staticClass:"otcDetailOrder-bar"},t._l(t.domArr,(function(e,s){return a("div",{key:s,staticClass:"bar-page"},[a("span",{staticClass:"bar-page-ball",class:e.class,staticStyle:{color:"#EDF4F8 !important"}},[t._v(t._s(s+1))]),a("span",{staticClass:"bar-page-text"},[t._v(t._s(e.text))]),a("div",{staticClass:"bar-line a-4-bg"})])})),0),t.isReady?a("div",{staticClass:"otcDetailOrder-text"},["1"===t.status&&"BUY"===t.commonData.side?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v(t._s(t.$t("otcDetailOrder.PendingPayment")))]),t._v(" \n      "),a("span",{staticClass:"b-1-cl info"},[t._v(t._s(t.$t("otcDetailOrder.CountdownPayments"))+"：")]),a("span",{staticClass:"b-7-cl Conspicuous"},[t._v(t._s(t.timer))])]):t._e(),"1"===t.status&&"SELL"===t.commonData.side?a("div",[a("span",{staticClass:"b-1-cl info"},[t._v(t._s(t.$t("otcDetailOrder.WaitingCountdownPayment"))+"：")]),a("span",{staticClass:"b-7-cl Conspicuous"},[t._v(t._s(t.timer))])]):t._e(),"2"===t.status&&"BUY"===t.commonData.side?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v(t._s(t.$t("otcDetailOrder.MoneyCollected")))]),t._v(" \n      "),a("span",{staticClass:"b-1-cl info"},[t._v(t._s(t.$t("otcDetailOrder.MoneyCollectedWarning")))])]):t._e(),"2"===t.status&&"SELL"===t.commonData.side?a("div",[a("span",{staticClass:"b-1-cl info"},[t._v("\n        "+t._s(t.$t("otcDetailOrder.otherPartyPaid1"))+"\n        "),t._v("\n        "+t._s(t.$t("otcDetailOrder.otherPartyPaid2"))+"\n         "+t._s(t.payText)+"\n        "+t._s(t.$t("otcDetailOrder.otherPartyPaid3"))+"\n         "+t._s(t.commonData.totalPrice)+" "+t._s(t.commonData.paycoin))])]):t._e(),"3"===t.status&&"BUY"===t.commonData.side?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v("\n        "+t._s(t.$t("otcDetailOrder.Completedbuy1"))+"\n      ")]),t._v("  \n      "),a("span",{staticClass:"small"},[t._v("\n        "+t._s(t.$t("otcDetailOrder.Completedbuy2"))+"\n      ")]),a("span",{staticClass:"active b-4-cl",on:{click:t.goAss}},[t._v(" "+t._s(t.$t("otcDetailOrder.Completedbuy3"))+" ")]),a("span",{staticClass:"small"},[t._v("\n        "+t._s(t.isCoOpen?t.$t("otcDetailOrder.CoCompletedbuy4"):t.$t("otcDetailOrder.Completedbuy4"))+"\n      ")])]):t._e(),"3"===t.status&&"SELL"===t.commonData.side?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v("\n        "+t._s(t.$t("otcDetailOrder.Completedsell"))+"\n      ")])]):t._e(),"4"===t.status||"9"===t.status?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v("\n      "+t._s(t.$t("otcDetailOrder.TitleOrderClose"))+"\n    ")])]):t._e(),"5"===t.status?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v("\n        "+t._s(t.$t("otcDetailOrder.TitleComplaint"))+"\n      ")]),t._v("  \n      "),a("span",{staticClass:"small"},[t._v(t._s(t.$t("otcDetailOrder.TitleComplaintText")))])]):t._e(),"7"===t.status?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v("\n      "+t._s(t.$t("otcDetailOrder.TitleOrderException"))+"\n    ")])]):t._e(),"8"===t.status&&"BUY"===t.commonData.side?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v("\n        "+t._s(t.$t("otcDetailOrder.AfterAppealbuy1"))+"\n      ")]),t._v("  \n      "),a("span",{staticClass:"small"},[t._v("\n        "+t._s(t.$t("otcDetailOrder.AfterAppealbuy2"))+"\n      ")]),a("span",{staticClass:"active b-4-cl",on:{click:t.goAss}},[t._v(" "+t._s(t.$t("otcDetailOrder.AfterAppealbuy3"))+" ")]),a("span",{staticClass:"small"},[t._v("\n        "+t._s(t.isCoOpen?t.$t("otcDetailOrder.CoAfterAppealbuy4"):t.$t("otcDetailOrder.AfterAppealbuy4"))+"\n        ")])]):t._e(),"8"===t.status&&"SELL"===t.commonData.side?a("div",[a("span",{staticClass:"b-7-cl Conspicuous"},[t._v(t._s(t.$t("otcDetailOrder.AfterAppealsell")))])]):t._e()]):t._e()])}),m=[],d={name:"otcDetailOrder-title",data:function(){return{djsTime:0,timer:"",vTimer:null}},props:{commonData:{default:function(){return{}},type:Object},isReady:{default:!1,type:Boolean}},watch:{status:function(t){"1"===t&&this.commonData.limitTime&&this.isReady?(this.djsTime=this.commonData.limitTime,this.setTime()):"1"!==t&&"0"!==t&&this.vTimer&&clearInterval(this.vTimer)}},computed:{payText:function(){var t=this,e="";return this.commonData.payKey&&this.commonData.payment&&this.$store.state.baseData.otcPublicInfo&&this.$store.state.baseData.otcPublicInfo.payments&&(this.$store.state.baseData.otcPublicInfo.payments.forEach((function(a){a.key===t.commonData.payKey&&(e=a.title)})),this.commonData.payment.forEach((function(a){a.payment===t.commonData.payKey&&(e+=" (".concat(a.account,") "))}))),e},status:function(){return this.commonData.status?this.commonData.status.toString():"0"},domArr:function(){var t=[{text:this.$t("otcDetailOrder.barText"),class:"a-12-bg b-1-cl"}];if(this.isReady){var e=this.commonData,a=e.status,s=e.side;"1"===a.toString()&&"BUY"===s?t.push({text:this.$t("otcDetailOrder.bar1Buy1"),class:"a-2-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar1Buy2"),class:"a-2-bg b-1-cl"}):"1"===a.toString()&&"SELL"===s?t.push({text:this.$t("otcDetailOrder.bar1Sell1"),class:"a-2-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar1Sell2"),class:"a-2-bg b-1-cl"}):"2"===a.toString()&&"BUY"===s?t.push({text:this.$t("otcDetailOrder.bar2Buy1"),class:"a-12-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar2Buy2"),class:"a-2-bg b-1-cl"}):"2"===a.toString()&&"SELL"===s?t.push({text:this.$t("otcDetailOrder.bar2Sell1"),class:"a-12-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar2Sell2"),class:"a-2-bg b-1-cl"}):"3"===a.toString()&&"BUY"===s?t.push({text:this.$t("otcDetailOrder.bar3Buy1"),class:"a-12-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar3Buy2"),class:"a-12-bg b-1-cl"}):"3"===a.toString()&&"SELL"===s?t.push({text:this.$t("otcDetailOrder.bar3Sell1"),class:"a-12-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar3Sell2"),class:"a-12-bg b-1-cl"}):"4"===a.toString()||"9"===a.toString()?t.push({text:this.$t("otcDetailOrder.bar4Sell"),class:"a-12-bg b-1-cl"}):"5"===a.toString()?t.push({text:this.$t("otcDetailOrder.bar5Sell"),class:"a-12-bg b-1-cl"}):"7"===a.toString()?t.push({text:this.$t("otcDetailOrder.bar7Sell"),class:"a-12-bg b-1-cl"}):"8"===a.toString()&&"BUY"===s?t.push({text:this.$t("otcDetailOrder.bar8Buy1"),class:"a-12-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar8Buy2"),class:"a-12-bg b-1-cl"}):"8"===a.toString()&&"SELL"===s&&t.push({text:this.$t("otcDetailOrder.bar8Sell1"),class:"a-12-bg b-1-cl"},{text:this.$t("otcDetailOrder.bar8Sell2"),class:"a-12-bg b-1-cl"})}return t}},beforeDestroy:function(){clearInterval(this.vTimer)},methods:{goAss:function(){this.$router.push("/assets/otcAccount")},setTime:function(){var t=this;this.timer=this.initTime(this.djsTime),this.vTimer=setInterval((function(){if(t.djsTime-=1e3,t.djsTime<=0)return clearInterval(t.vTimer),void t.$emit("getData");t.timer=t.initTime(t.djsTime)}),1e3)},initTime:function(t){var e=Object(n["t"])(t),a=e.day,s=e.hour,i=e.min,r=e.sec,o="";return Number(a)&&(o+="".concat(a).concat(this.$t("otcDetailOrder.day"))),Number(s)&&(o+="".concat(s).concat(this.$t("otcDetailOrder.hour"))),Number(i)&&(o+="".concat(i).concat(this.$t("otcDetailOrder.min"))),o+="".concat(r).concat(this.$t("otcDetailOrder.sec")),o}}},p=(a("eec0"),{mixins:[d]}),h=p,g=a("2877"),f=Object(g["a"])(h,u,m,!1,null,null,null),v=f.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isReady?a("div",{staticClass:"otcDetailOrder-message otcDetailOrder-message-container a-3-bd clearfix"},[a("ul",{staticClass:"otcDetailOrder-keys"},[t.identificationInfo.otcAuthnameOpen?a("li",[t._v(t._s(t.$t("otcDetailOrder.identification")))]):t._e(),a("li",[t._v(t._s(t.$t("otcDetailOrder.MessPrice")))]),a("li",[t._v(t._s(t.$t("otcDetailOrder.MessVolume")))]),a("li",[t._v(t._s(t.$t("otcDetailOrder.MessTotol")))]),a("li",[t._v(t._s(t.$t("otcDetailOrder.MessMerchantRemarks")))])]),a("ul",{staticClass:"otcDetailOrder-values b-1-cl"},[t.identificationInfo.otcAuthnameOpen?a("li",[t._v(t._s(t.identificationInfo.realName)+"\n      "),a("a",{staticClass:"identification-icon",attrs:{href:"javascript:;"},on:{click:t.identificationShow}},[a("svg",{staticClass:"icon icon-16 identifi-icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-b_29"}})]),a("svg",{staticClass:"icon icon-16 identifi-icon-hover",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-b_29_1"}})])])]):t._e(),a("li",[t._v(t._s(t.commonData.price)+" "+t._s(t.commonData.paycoin))]),a("li",[t._v(t._s(t.commonData.volume)+" "+t._s(t.commonData.coin))]),a("li",{staticClass:"b-7-cl"},[t._v(t._s(t.commonData.totalPrice)+" "+t._s(t.commonData.paycoin))]),t.showDescription?a("li",[t._v(t._s(t.commonData.description))]):a("li",[t._v(t._s(t.$t("otcDetailOrder.none")))])])]):t._e()},y=[],D={props:{commonData:{default:function(){return{}},type:Object},isReady:{default:!1,type:Boolean}},methods:{getShowCoin:function(t){var e=t;return this.market&&this.market.coinList&&(e=Object(n["l"])(t,this.market.coinList)),e},identificationShow:function(){this.$emit("update:identificationShow",!0)}},computed:{market:function(){return this.$store.state.baseData.market},identificationInfo:function(){var t={otcAuthnameOpen:0},e={SELL:"buyer",BUY:"seller"};if(this.commonData.side){var a=this.commonData[e[this.commonData.side]];a&&(t.realName=a.realName,t.mobileNumber=a.mobileNumber,t.email=a.email,this.commonData.otcAuthnameOpen&&(t.otcAuthnameOpen=Number(this.commonData.otcAuthnameOpen)))}return t},showDescription:function(){var t=!1;return this.commonData.description&&this.commonData.description.length&&(t=!0),t}}},C=(a("6c57"),{mixins:[D]}),_=C,O=Object(g["a"])(_,b,y,!1,null,null,null),x=O.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isReady?a("section",{staticClass:"otcDetailOrder-pays  clearfix"},[a("span",{staticClass:"otcDetailOrder-pays-title"},[t._v(t._s(t.$t("otcDetailOrder.SellersPaymentMethod")))]),a("div",{staticClass:"otcDetailOrder-pays-body"},[t.showPay?a("ul",{staticClass:"paysList"},t._l(t.pays,(function(e,s){return a("li",{key:s,staticClass:"clearfix"},["BUY"===t.commonData.side?a("div",{staticClass:"paysList-redio",on:{click:function(a){return t.payClick(e)}}},[a("c-redio",{attrs:{value:t.payObj.payment===e.payment}})],1):t._e(),"otc.payment.alipay"===e.payment||"otc.payment.wxpay"===e.payment?a("div",{staticClass:"paysList-message clearfix"},[a("div",{staticClass:"paysList-message-type b-1-cl"},[t._v(t._s(e.name))]),a("div",[a("span",{staticClass:"paysList-message-text"},[t._v(t._s(e.userName)+" "+t._s(e.account))]),"BUY"===t.commonData.side?a("span",{staticClass:"paysList-message-ewm a-2-bg"},[a("svg",{staticClass:"icon icon-18",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-b_18"}})]),a("div",{staticClass:"paysList-message-ewm-mark h-2-bg"},[a("img",{attrs:{src:e.qrcodeImg}})])]):t._e()])]):"otc.payment.domestic.bank.transfer"===e.payment?a("div",{staticClass:"paysList-message clearfix"},[a("div",{staticClass:"paysList-message-type b-1-cl"},[t._v(t._s(e.name))]),a("div",{staticClass:"paysList-message-bank"},[t._v("\n            "+t._s(e.userName)+" "+t._s(e.account)+" "+t._s(e.bankName)+" "+t._s(e.bankOfDeposit)+"\n          ")])]):a("div",{staticClass:"paysList-message clearfix"},[a("div",{staticClass:"paysList-message-type b-1-cl"},[t._v(t._s(e.name))]),a("div",[a("span",{staticClass:"paysList-message-text"},[t._v(t._s(e.userName)+" "+t._s(e.account))])])])])})),0):t._e(),t.showText.length?a("div",{staticClass:"b-1-cl text"},[t._v(t._s(t.showText))]):t._e()])]):t._e()},T=[],S={props:{commonData:{default:function(){return{}},type:Object},isReady:{default:!1,type:Boolean},payObj:{default:function(){return{}},type:Object}},computed:{otcPublicInfo:function(){return this.$store.state.baseData.otcPublicInfo},pays:function(){var t=this,e=[];return this.isReady&&this.otcPublicInfo.payments&&this.commonData.payment&&this.commonData.payment.forEach((function(a){if(a){var s=a;t.otcPublicInfo.payments.forEach((function(t){a.payment===t.key&&(s.name=t.title)})),e.push(s)}})),e},status:function(){return this.commonData.status?this.commonData.status.toString():"0"},showText:function(){var t="";if(this.isReady){var e=this.commonData.side;"BUY"===e&&"2"===this.status?t=this.$t("otcDetailOrder.paysBuy2"):"BUY"===e&&"3"===this.status?t=this.$t("otcDetailOrder.paysBuy3"):"SELL"===e&&"3"===this.status?t=this.$t("otcDetailOrder.paysSell3"):"4"===this.status||"9"===this.status?t=this.$t("otcDetailOrder.pays4"):"5"===this.status?t=this.$t("otcDetailOrder.pays5"):"7"===this.status?t=this.$t("otcDetailOrder.pays7"):"BUY"===e&&"8"===this.status?t=this.$t("otcDetailOrder.paysBuy8"):"SELL"===e&&"8"===this.status&&(t=this.$t("otcDetailOrder.paysSell8"))}return t},showPay:function(){var t=!1;if(this.isReady){var e=this.commonData.side;("1"===this.status||"SELL"===e&&"2"===this.status)&&(t=!0)}return t}},methods:{payClick:function(t){this.$emit("setPayObj",t)}}},k=(a("7ae5"),{mixins:[S]}),L=k,I=Object(g["a"])(L,$,T,!1,null,null,null),w=I.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isReady?a("section",{staticClass:"otcDeatilOrder-chat a-4-bg",style:{height:t.chatHeight+"px",top:t.chatTop-1+"px"}},["5"===t.status&&"1"===t.commonData.isComplainUser.toString()?a("ul",{staticClass:"chat-title a-2-bd"},[a("li",{class:"server"===t.tab?"b-2-cl":"",on:{click:function(e){return t.setTab("server")}}},[t._v("\n      "+t._s(t.$t("otcDetailOrder.chatServer"))+"\n      "),"server"===t.tab?a("span",{staticClass:"a-12-bg"}):t._e()]),a("li",{class:"user"===t.tab?"b-2-cl":"",on:{click:function(e){return t.setTab("user")}}},[t._v("\n      "+t._s(t.$t("otcDetailOrder.chatUser"))+"\n      "),"user"===t.tab?a("span",{staticClass:"a-12-bg"}):t._e()])]):t._e(),a("div",{staticClass:"chat-content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"server"===t.tab,expression:"tab === 'server'"}],staticClass:"chat-server"},[a("div",{staticClass:"chat-server-message",style:{height:t.chatServerHeight+"px"}},[a("vue-scroll",{ref:"serverMessage"},[a("ul",{ref:"serverList"},[a("li",{staticClass:"chat-server-first"},[t._v("\n            "+t._s(t.$t("otcDetailOrder.chatServerMessage"))+"\n          ")]),t._l(t.serverData,(function(e,s){return a("li",{key:s,staticClass:"chat-item clearfix",class:"2"===e.userType.toString()?"chat-right":"chat-left"},[a("div",{staticClass:"chat-page",class:"2"===e.userType.toString()?"chat-right a-12-bg":"chat-left"},["1"===e.userType.toString()?a("div",[a("svg",{staticClass:"icon icon-30",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-h_2"}})])]):a("div",[t.serverMy.imageUrl.length?a("img",{attrs:{src:t.serverMy.imageUrl}}):a("span",{staticClass:"b-2-cl"},[t._v(t._s(t.serverMy.otcNickName[0]))])])]),a("div",{staticClass:"chat-message"},[a("div",{staticClass:"clearfix"},["1"===e.contentType.toString()?a("div",{staticClass:"chat-message-text",class:"2"===e.userType.toString()?"a-12-bg b-8-cl":"a-2-bg b-1-cl"},[t._v("\n                  "+t._s(e.replayContent)+"\n                ")]):t._e(),"2"===e.contentType.toString()?a("div",{staticClass:"chat-message-img a-2-bg"},[a("img",{attrs:{src:e.replayContent}})]):t._e()]),a("div",{staticClass:"chat-message-time"},[t._v(t._s(t._f("setTime")(e.ctime)))])])])}))],2)])],1),a("div",{staticClass:"chat-send a-2-bg"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.serverInp,expression:"serverInp"}],staticClass:"b-1-cl textInput",attrs:{maxlength:"50",placeholder:t.$t("otcDetailOrder.chatServerInp")},domProps:{value:t.serverInp},on:{keyup:t.serverInpKeyup,input:function(e){e.target.composing||(t.serverInp=e.target.value)}}}),a("div",{staticClass:"sendButton"},[a("div",{staticClass:"sendButton-img"},[a("span",[a("svg",{staticClass:"icon icon-30",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-h_3"}})])]),a("input",{ref:"fileInp",staticClass:"files",attrs:{type:"file",accept:"image/gif, image/jpeg, image/jpg",name:"file"},on:{change:t.fileChange}})]),a("c-button",{staticClass:"buttonClass",attrs:{height:"30px",disabled:t.serverBtnDisabled,loading:t.serverBtnLoading,name:"serverButton"},on:{click:t.serverBtnClick}},[t._v(t._s(t.$t("otcDetailOrder.chatServerBut")))])],1)])]),a("div",{directives:[{name:"show",rawName:"v-show",value:"user"===t.tab,expression:"tab === 'user'"}],staticClass:"chat-user"},[a("div",{staticClass:"chat-user-title a-2-bg"},[a("div",{staticClass:"a-12-bg user-page",on:{click:function(e){return t.goUid(t.userMess.uid)}}},[t.userMess.imageUrl.length?a("img",{attrs:{src:t.userMess.imageUrl}}):a("span",{staticClass:"b-8-cl"},[t._v(t._s(t.userMess.otcNickName[0]))])]),a("div",{staticClass:"user-mess"},[a("div",{staticClass:"user-name b-2-cl"},[t._v("\n            "+t._s(t.userMess.otcNickName)+"\n            "),a("span",{staticStyle:{"margin-left":"6px"},domProps:{innerHTML:t._s(t.userVip)}})]),a("div",{staticClass:"user-status"},[t._v("\n            "+t._s("1"===t.userMess.isOnline.toString()?t.$t("otcDetailOrder.inline"):t.$t("otcDetailOrder.outline"))+"\n          ")])]),a("div",{staticClass:"user-text"},[a("div",{staticClass:"user-name b-2-cl"},[t._v(" "+t._s(t.userMess.completeOrders)+" ")]),a("div",{staticClass:"user-status"},[t._v(" "+t._s(t.$t("otcDetailOrder.chatVolume"))+" ")])])]),a("div",{staticClass:"chat-user-message",style:{height:t.chatUserHeight+"px"}},[a("vue-scroll",{ref:"userMessage",attrs:{opt:t.userScrollOpt}},[a("ul",{ref:"userList"},t._l(t.userData,(function(e,s){return a("li",{key:s,staticClass:"chat-item clearfix",class:"2"===e.userType.toString()?"chat-right":"chat-left"},[a("div",{staticClass:"chat-page a-12-bg"},[e.obj.imageUrl.length?a("img",{attrs:{src:e.obj.imageUrl}}):a("span",{staticClass:"b-8-cl"},[t._v(t._s(e.obj.otcNickName[0]))])]),a("div",{staticClass:"chat-message"},[a("div",{staticClass:"clearfix"},["1"===e.contentType.toString()?a("div",{staticClass:"chat-message-text",class:"2"===e.userType.toString()?"a-12-bg b-8-cl":"a-2-bg b-1-cl"},[t._v("\n                  "+t._s(e.replayContent)+"\n                ")]):t._e(),"2"===e.contentType.toString()?a("div",{staticClass:"chat-message-img a-2-bg"},[a("img",{attrs:{src:e.replayContent}})]):t._e()]),a("div",{staticClass:"chat-message-time"},[t._v(t._s(t._f("setTime")(e.ctime)))])])])})),0)])],1),a("div",{staticClass:"chat-send a-2-bg"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.userInp,expression:"userInp"}],ref:"userInput",staticClass:"b-1-cl textInput",attrs:{maxlength:"50",placeholder:t.$t("otcDetailOrder.chatUserInp")},domProps:{value:t.userInp},on:{keyup:t.userInpKeyup,input:function(e){e.target.composing||(t.userInp=e.target.value)}}}),a("div",{staticClass:"sendButton"},[a("c-button",{staticClass:"buttonClass",attrs:{height:"30px",name:"userButton",disabled:t.userBtnDisabled,loading:t.userBtnLoading},on:{click:t.userBtnClick}},[t._v("\n            "+t._s(t.$t("otcDetailOrder.chatUserBut"))+"\n          ")])],1)])])])]):t._e()},B=[],j=(a("7f7f"),a("75fc")),M={data:function(){return{userScrollOpt:{detectResize:!0,scrollPanel:{initialScrollY:999999,initialScrollX:!1,scrollingX:!0,scrollingY:!0,speed:300,easing:void 0,verticalNativeBarPos:"right"}},tab:"",serverData:[],serverInp:"",serverBtnLoading:!1,serverTimer:null,serverScroll:!1,userBtnLoading:!1,userWs:null,userWsReady:!1,userData:[],userInp:"",chatId:"",userTime:null,wsTime:null,sendTimer:null,resetTimer:null,chatHeight:684,userTimes:null}},props:{commonData:{default:function(){return{}},type:Object},isReady:{default:!1,type:Boolean},chatTop:{default:0,type:Number}},filters:{setTime:function(t){return Object(n["G"])(new Date(Number(t)),"yyyy-MM-dd hh:mm:ss")}},watch:{status:function(t){"5"===t&&"1"===this.commonData.isComplainUser.toString()?this.tab="server":this.tab="user"},tab:function(t){"server"===t?(this.sendTimer&&clearTimeout(this.sendTimer),this.resetTimer&&clearTimeout(this.resetTimer),this.userWsReady&&this.userWs.close(),this.getServerData(),this.serverScroll=!0):"user"===t&&(this.serverTimer&&clearInterval(this.serverTimer),this.initUser())}},computed:{userVip:function(){var t="";return this.userInfo&&this.userInfo.otcCompanyInfo&&Number(this.userInfo.otcCompanyInfo.status)&&(1===this.userMess.companyLevel?t='<svg class="icon icon-16" aria-hidden="true">\n              <use xlink:href="#icon-c_16"></use>\n            </svg>':2===this.userMess.companyLevel&&(t='<svg class="icon icon-16" aria-hidden="true">\n              <use xlink:href="#icon-c_17"></use>\n            </svg>')),t},userInfo:function(){return this.$store.state.baseData.userInfo},serverMy:function(){var t={};return t="BUY"===this.commonData.side?this.commonData.buyer:this.commonData.seller,t},userMess:function(){var t={};return"BUY"===this.commonData.side?t=this.commonData.seller:"SELL"===this.commonData.side&&(t=this.commonData.buyer),t},otcWsUrl:function(){var t="";return this.$store.state.baseData.otcPublicInfo&&(t=this.$store.state.baseData.otcPublicInfo.otcChatWS),t},serverBtnDisabled:function(){var t=!0;return(this.serverInp.length||this.serverBtnLoading)&&(t=!1),t},userBtnDisabled:function(){var t=!0;return(this.userInp.length||this.userBtnLoading)&&(t=!1),t},status:function(){return this.commonData.status?this.commonData.status.toString():"0"},chatUserHeight:function(){return"5"===this.status&&"1"===this.commonData.isComplainUser.toString()?this.chatHeight-50-86-60:this.chatHeight-86-60},chatServerHeight:function(){return this.chatHeight-50-60-6},userSide:function(){var t="",e="";return"BUY"===this.commonData.side?(t=this.commonData.buyer.uid.toString(),e=this.commonData.seller.uid.toString()):"SELL"===this.commonData.side&&(t=this.commonData.seller.uid.toString(),e=this.commonData.buyer.uid.toString()),{from:t,to:e}}},beforeDestroy:function(){this.beforeDestroyMethods()},methods:{beforeDestroyMethods:function(){this.tab="",this.userWsReady&&this.userWs.close(),this.userWs=null,clearInterval(this.serverTimer),clearTimeout(this.sendTimer),clearTimeout(this.resetTimer)},goUid:function(t){t&&this.$router.push("/stranger?uid=".concat(t))},userInpKeyup:function(t){13===t.keyCode&&this.$bus.$emit("button-click","userButton")},serverInpKeyup:function(t){13===t.keyCode&&this.$bus.$emit("button-click","serverButton")},userBtnClick:function(){var t=this;this.userWsReady&&(this.userBtnLoading=!0,this.sendTimer=setTimeout((function(){t.userBtnLoading&&(t.userBtnLoading=!1,t.userWs&&t.userWsReady&&(t.userWs.close(),t.userInp=""))}),5e3),this.userTime=(new Date).getTime(),this.userWs.send(JSON.stringify({chatId:this.chatId,message:{content:this.userInp,from:this.userSide.from,to:this.userSide.to,orderId:this.commonData.sequence,time:this.userTime},type:"message"})))},getUserData:function(){var t=this;this.axios({url:"/chatMsg/message",method:"post",params:{fromId:this.userSide.from,toId:this.userSide.to,orderId:this.commonData.sequence},hostType:"otc"}).then((function(e){if("0"===e.code.toString()){var a=[];e.data.forEach((function(e){var s={};s="BUY"===t.commonData.side?e.fromId===t.userSide.from?t.commonData.buyer:t.commonData.seller:e.fromId===t.userSide.from?t.commonData.seller:t.commonData.buyer,a.push({replayContent:e.content,contentType:"1",userType:e.fromId===t.userSide.from?"2":"1",ctime:e.ctime,obj:s})})),t.userData=a,t.$nextTick((function(){t.$refs.userMessage.scrollTo({y:"100%"},!1)}))}else t.$bus.$emit("tip",{text:e.msg,type:"error"})}))},initUser:function(){var t=this;if("user"===this.tab&&(this.getUserData(),this.otcWsUrl.length)){this.userWs=null,this.wsTime=(new Date).getTime();var e=this.userSide.from+this.userSide.to;this.userWs=new WebSocket("".concat(this.otcWsUrl,"/").concat(window.btoa(e))),this.userWs.onopen=function(){"user"===t.tab&&(t.userWsReady=!0)},this.userWs.onmessage=function(e){if("user"===t.tab&&e.data){var a=JSON.parse(e.data);if(t.chatId=a.chatId,a.message){Number(a.message.time)===Number(t.userTime)&&(t.userBtnLoading=!1,t.userInp="");var s={};s="BUY"===t.commonData.side?a.message.from===t.userSide.from?t.commonData.buyer:t.commonData.seller:a.message.from===t.userSide.from?t.commonData.seller:t.commonData.buyer,t.userData.push({replayContent:a.message.content,contentType:"1",userType:a.message.from===t.userSide.from?"2":"1",ctime:a.message.time,obj:s}),t.$nextTick((function(){t.$refs.userMessage.scrollTo({y:"100%"},!1)}))}}},this.userWs.onerror=function(){"user"===t.tab&&t.userWs.close()},this.userWs.onclose=function(){if("user"===t.tab){t.userWsReady=!1;var e=(new Date).getTime(),a=e-t.wsTime;a>3e3?t.initUser():t.resetTimer=setTimeout((function(){clearTimeout(t.resetTimer),t.initUser()}),3e3-a)}}}},serverBtnClick:function(){var t=this;this.serverBtnLoading=!0,this.axios({url:"/question/reply_create",method:"post",params:{rqId:this.commonData.complainId,rqReplyContent:this.serverInp,contentType:"1"}}).then((function(e){t.serverBtnLoading=!1,"0"===e.code.toString()?(t.serverScroll=!0,t.getServerData(),t.serverInp=""):t.$bus.$emit("tip",{text:e.msg,type:"error"})}))},setTab:function(t){this.tab=t},getServerData:function(){var t=this;clearInterval(this.serverTimer),this.axiosServer(),this.serverTimer=setInterval((function(){t.axiosServer(!0)}),3e3)},axiosServer:function(t){var e=this,a={};t&&(a["exchange-auto"]="1"),this.axios({url:"/question/details_problem",headers:a,params:{id:this.commonData.complainId}}).then((function(t){if("0"===t.code.toString()){var a=[];t.data.rqInfo&&a.push({replayContent:t.data.rqInfo.rqDescribe,contentType:"1",userType:"2",ctime:t.data.rqInfo.ctime}),e.serverData=[].concat(a,Object(j["a"])(t.data.rqReplyList)),e.$nextTick((function(){e.serverScroll&&(e.serverScroll=!1,e.$refs.serverMessage.scrollTo({y:"100%"},!1))}))}else e.$bus.$emit("tip",{text:t.msg,type:"error"})}))},fileChange:function(t){var e=this,a=t.srcElement.files[0].size/1024/1024;if(a<=2){var s=new FormData;s.append("file",this.$refs.fileInp.files[0],this.$refs.fileInp.files[0].name),this.axios({url:"common/upload_img",headers:{"Content-Type":"multipart/form-data"},params:s,method:"post"}).then((function(t){"0"===t.code?e.axios({url:"/question/reply_create",method:"post",params:{rqId:e.commonData.complainId,rqReplyContent:t.data.filename,contentType:"2"}}).then((function(t){"0"===t.code.toString()?(e.serverScroll=!0,e.getServerData()):e.$bus.$emit("tip",{text:t.msg,type:"error"})})):e.$bus.$emit("tip",{text:t.msg,type:"error"})}))}else this.$bus.$emit("tip",{text:"请上传2MB以内的图片",type:"warning"})}}},A=(a("9fea"),{mixins:[M]}),E=A,U=Object(g["a"])(E,P,B,!1,null,null,null),F=U.exports,N={mixins:[l],components:{Title:v,Message:x,Pays:w,chatVue:F},mounted:function(){this.init()}},W=N,R=Object(g["a"])(W,s,i,!1,null,null,null);e["default"]=R.exports},"57f9":function(t,e,a){},"6c57":function(t,e,a){},"7ae5":function(t,e,a){},"9fea":function(t,e,a){},eec0:function(t,e,a){}}]);